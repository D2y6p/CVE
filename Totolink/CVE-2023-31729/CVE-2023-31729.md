# Basic information #
	- ## CVE-ID: ## CVE-2023-31729
	- ## Vendor: ## Totolink
	- ## Product: ## A3300R - V17.0.0cu.557_B20221024
	- ## Firmware version: ## the latest V17.0.0cu.557_B20221024 firmware version
	- ## Type: ## command injection

# Vulnerability description #
FIRMWA DOWNLOAD: HTTPS://WWW.TOTOLINK.CN/DATA/UPLOAD/20230228/EEA9795866EA68EE471C1B6573A370E1.RAR

TOTOLINK A3300R V17.0.0CU.557 ROUTER HAS A COMMAND INJECTION VULNERABILITY IN THE REQUEST /CGI-BIN/CSTECGI.CGI BY FUNCSION SETDDNSCFG. 
TOTOLINK A3300R V17.0.0CU.557 ROUTER HAS A COMMAND INJECTION VULNERABILITY IN THE REQUEST /CGI-BIN/CSTECGI.CGI BY FUNCSION SETIPTVCFG. 
TOTOLINK A3300R V17.0.0CU.557 ROUTER HAS A COMMAND INJECTION VULNERABILITY IN THE REQUEST /CGI-BIN/CSTECGI.CGI BY FUNCSION SETIPV6CFG. 
TOTOLINK A3300R V17.0.0CU.557 ROUTER HAS A COMMAND INJECTION VULNERABILITY IN THE REQUEST /CGI-BIN/CSTECGI.CGI BY FUNCSION SETLANCFG. 
TOTOLINK A3300R V17.0.0CU.557 ROUTER HAS A COMMAND INJECTION VULNERABILITY IN THE REQUEST /CGI-BIN/CSTECGI.CGI BY FUNCSION SETREMOTECFG. 
TOTOLINK A3300R V17.0.0CU.557 ROUTER HAS A COMMAND INJECTION VULNERABILITY IN THE REQUEST /CGI-BIN/CSTECGI.CGI BY FUNCSION SETSCHEDULECFG. 
TOTOLINK A3300R V17.0.0CU.557 ROUTER HAS A COMMAND INJECTION VULNERABILITY IN THE REQUEST /CGI-BIN/CSTECGI.CGI BY FUNCSION SETTRACEROUTECFG. 
TOTOLINK A3300R V17.0.0CU.557 ROUTER HAS A COMMAND INJECTION VULNERABILITY IN THE REQUEST /CGI-BIN/CSTECGI.CGI BY FUNCSION SETURLFILTERRULES.
TOTOLINK A3300R V17.0.0CU.557 ROUTER HAS A COMMAND INJECTION VULNERABILITY IN THE REQUEST /CGI-BIN/CSTECGI.CGI BY FUNCSION SETWANCFG.

# Vulnerability Proof #
## run Poc ##
![](./img/1.png)
![](./img/2.png)
![](./img/3.png)

# repair suggestion #
Filter characters such as **` $ | & ;** for the hostname parameter in the setwancfg function.